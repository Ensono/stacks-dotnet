contexts:
  powershell:
    container:
      shell: pwsh
      shell_args:
        - run
        - --rm
        - -v
        - ${PWD}:/eirctl
        - -v
        - /var/run/docker.sock:/var/run/docker.sock
        - -e
        - PSModulePath=/modules
        - -w
        - /app
        - --env-file
        - envfile
        - ensonostackseuweirdfmu.azurecr.io/ensono/eir-infrastructure:1.1.159
        - pwsh
        - -NoProfile
        - -Command
    envfile:
      exclude:
        - path
        - home
        - kubeconfig

  powershell-dotnet:
    container:
      shell: pwsh
      args:
        - run
        - --rm
        - -v
        - ${PWD}:/app
        - -v
        - /var/run/docker.sock:/var/run/docker.sock
        - -e
        - PSModulePath=/modules
        - -w
        - /app
        - --env-file
        - envfile
        - ensonostackseuweirdfmu.azurecr.io/ensono/eir-dotnet:1.1.159
        - pwsh
        - -NoProfile
        - -Command
    env:
      DOTNET_ARGUMENTS: "-v q /p:CollectCoverage=true /p:CoverletOutputFormat=opencover"
    envfile:
      exclude:
        - path
        - home
        - kubeconfig
